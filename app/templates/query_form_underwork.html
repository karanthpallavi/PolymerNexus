<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>SPARQL Query Form</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            margin: 20px;
            padding: 20px;
            text-align: center;
        }
        h1 {
            color: #333;
        }
        form {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            display: inline-block;
            text-align: left;
        }
        textarea, select, input {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 14px;
        }
        button {
            background-color: #a6f5f0;
            color: black;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background-color: #8edbd5;
        }
        .hidden {
            display: none;
        }
    </style>
    <script>
        function updateForm() {
            var schema = document.getElementById("schema").value;
            var measurementFields = document.getElementById("measurement-fields");

            if (schema === "measurement") {
                measurementFields.classList.remove("hidden");
                fetchSlots(); // Load slots dynamically
            } else {
                measurementFields.classList.add("hidden");
            }
        }

        function fetchSlots() {
        fetch('/get_slots')
            .then(response => response.json())
            .then(data => {
                console.log("Fetched slots:", data);  // Debug: Print fetched data

                let slotSelect = document.getElementById("measurement_slot");
                slotSelect.innerHTML = "<option value=''>-- Select Slot --</option>"; // Reset options

                data.forEach(entry => {
                    let option = document.createElement("option");
                    option.value = entry.slot_name;
                    option.textContent = `${entry.slot_name} (${entry.range_name})`;
                    slotSelect.appendChild(option);
                });
            })
            .catch(error => console.error('Error fetching slots:', error));
    }
        window.onload = function() {
            document.getElementById("query").value = `
PREFIX iao: <http://purl.obolibrary.org/obo/iao.owl/>
PREFIX obi: <http://purl.obolibrary.org/obo/obi.owl/>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX schema: <http://schema.org/>
PREFIX pmd: <https://w3id.org/pmd/co/>
PREFIX obo: <http://purl.obolibrary.org/obo/>
PREFIX bfo: <http://purl.obolibrary.org/obo/bfo.owl/>
PREFIX isk: <https://tib.eu/ontologies/isk/>
PREFIX time: <http://www.w3.org/2006/time/>
PREFIX stato: <http://purl.obolibrary.org/stato.owl/>

SELECT ?object ?quality ?numericvalue ?unit WHERE {
    ?smd rdf:type iao:IAO_0000032. #Scalar Measurement Datum
    ?smd iao:IAO_0000221 ?quality_uri. #Quality
    iao:IAO_0000136 rdfs:label ?isAbout.
    ?smd iao:IAO_0000136 ?object_uri.  #Object
    ?smd obi:OBI_0001938 ?valuespec. #Value specification
    obi:OBI_0001938 rdfs:label ?hasValSpec.
    ?valuespec obi:OBI_0001937 ?numericvalue. #Numeric Value for Quality
    obi:OBI_0001937 rdfs:label ?hasSpecNumVal.
    ?valuespec iao:IAO_0000039 ?unitInstance.
    ?unitInstance rdfs:label ?unit.
    ?object_uri rdfs:label ?object.
    ?quality_uri rdfs:label ?quality.

    #FILTER( regex(str(?smd),"https://tib.eu/ontologies/isk/411494_7022E_SMD_Trans_Cont"))
    #FILTER( regex(str(?object),"https://tib.eu/ontologies/isk/447567_7057D"))
    #FILTER(regex(str(?quality),"https://tib.eu/ontologies/isk/Cis_Cont"))
    #FILTER(regex(str(?numericvalue),"13.9^^xsd:float"))
}`;
            document.getElementById("nl_query").value = "Get all qualities, values from Arlanxeo Raw Data Repository";
        };
    </script>
</head>
<body>
<h1>SPARQL Query</h1>
<form action="/query" method="POST">
    <label for="template">Query Template:</label><br>
    <select id="template" name="template">
        <option value="">-- Select Template --</option>
        <option value="basic_measurements">Basic Measurements</option>
        <option value="filter_by_single_quality">Filter by Single Quality</option>
    </select><br>

    <!--<label for="value1">Value 1 (e.g., min threshold):</label><br>
    <input type="number" id="value1" name="value1" step="any"><br>

    <label for="value2">Value 2 (e.g., max threshold):</label><br>
    <input type="number" id="value2" name="value2" step="any"><br>-->

    <label for="quality">Select Quality:</label><br>
    <select id="quality" name="quality">
        <option value="">-- Select Quality --</option>
        <option value="ML 1+1">ML 1+1</option>
        <option value="ML 1+4">ML 1+4</option>
        <option value="D Median">D Median</option>
        <option value="E_dash_0_degree_celcius">E dash @0 degree celcius</option>
        <option value="E_dash_23_degree_celcius">E dash @23 degree celcius</option>
        <option value="E_dash_60_degree_celcius">E dash @60 degree celcius</option>
        <option value="E_double_dash_0_degree_celcius">E double dash @0 degree celcius</option>
        <option value="E_double_dash_23_degree_celcius">E double dash @23 degree celcius</option>
        <option value="E_double_dash_60_degree_celcius">E double dash @60 degree celcius</option>
        <option value="ElasticModulus_G_dash_15_percent_1_Messung">Elastic Modulus (G' @15 percent 1 Messung)</option>
        <option value="ElasticModulus_G_dash_zero_point_five_percent_1_Messung">Elastic Modulus (G' @0.5 percent 1 Messung)</option>
        <option value="F Median">F Median</option>
        <option value="Hardness_mean_value">Hardness mean value</option>
        <option value="LossModulus_Gdouble_dash(max)">Loss Modulus G''</option>
        <option value
        <!-- Add more qualities as needed -->
    </select><br>

    <label for="number_input">Enter a numeric value:</label><br>
    <input type="number" id="number_input" name="number_input" step="any"><br>

    <button type="submit">Run Query</button>
</form>
</body>
</html>